Управление в медико-биологических и экологических системах ББК 22.18 УРАВНЕНИЕ ГАМИЛЬТОНА-ЯКОБИ-БЕЛЛМАНА В ДИФФЕРЕНЦИАЛЬНЫХ ИГРАХ СО СЛУЧАЙНОЙ ПРОДОЛЖИТЕЛЬНОСТЬЮ 1 Шевкопляс Е. В. 2 (Факультет прикладной математики – процессов управления, Санкт-Петербургский государственный университет, Санкт-Петербург ) Рассматривается класс дифференциальных игр со случайной продолжительностью. Показывается, что задача со случайной продолжительностью может быть сведена к стандартной задаче с бесконечным временем. Для нахождения оптимальных решений в дифференциальных играх со случайной продолжительностью выводится уравнение типа Гамильтона-Якоби-Беллмана. Результаты демонстрируются на примере теоретико-игровой модели разработки невозобновляемых ресурсов. Задача решается при предположении о том, что случайная величина, соответствующая моменту окончания игры, распределена по закону Вейбулла. Ключевые слова: дифференциальные игры, уравнение Гамильтона-Якоби-Беллмана, случайная продолжительность, разработка невозобновляемых ресурсов. теория игр и ее приложения. – 2009. – Т. 1. №2». Викторовна Шевкопляс, кандидат физикоматематических наук (katya_shev@mail.ru).

Управление большими системами. Выпуск 26.1 Введение В настоящее время в теории игр, в том числе и в теории дифференциальных игр, достаточно ярко выражен интерес к более адекватному моделированию конфликтно-управляемых процессов, происходящих в реальности. При моделировании таких процессов необходимо учитывать стохастический характер окружающей нас действительности. В частности, очевидно, что любой реальный процесс, развивающийся во времени, также как и сама жизнь, имеет случайную продолжительность, поскольку заканчивается в некоторый случайный момент времени. В приложениях дифференциальных игр часто изучаются различные конфликтноуправляемые процессы в экономике, экологии, менеджменте и других сферах человеческой деятельности, которые развиваются во времени, а затем заканчиваются в фиксированный момент времени. Кроме того, в последнее время многие задачи, особенно в экономических приложениях, рассматриваются на бесконечном временном промежутке при условии дисконтирования мгновенных выигрышей во времени. На практике же такие процессы имеют случайный момент окончания, что связано со множеством причин неигрового характера. В том числе, недавно случившийся экономический кризис послужил основанием для досрочного прекращения многих товарно-денежных отношений. По этой причине рассмотрение игр со случайной продолжительностью представляется более реалистичным. Впервые постановка задачи со случайной продолжительностью дифференциальной игры была сформулирована в работе Петросяна Л.А., Мурзова Н.В. в 1966 году [7]. В данной работе изучалась антагонистическая игра преследования двух лиц с терминальными выигрышами в последний момент времени, который являлся случайной величиной с известной функцией распределения. Для игры в такой постановке впервые было выведено уравнение типа Айзекса-Беллмана. Затем общая постановка дифференциальной игры со случайной продолжительностью была представлена в работе Петросяна

Управление в медико-биологических и экологических системах Л.А., Шевкопляс Е.В. в 2000 году [8]. В данной работе изучались кооперативные дифференциальные игры со случайной продолжительностью, и акцент был сделан на проблеме динамической устойчивости принципов оптимальности в новой постановке игры. В то же время стоит отметить, что параллельно и независимо в теории оптимального управления рассматривались неигровые модели со случайной продолжительностью, начиная с работы M.E. Yaari [17] 1965 года, посвященной теории страхования жизни потребителя при неопределенном времени его смерти. В данной работе рассматриваются дифференциальные игры со случайной продолжительностью. В разделе 1 приводится постановка задачи, причем интегральные выигрыши игроков при помощи перестановки интегралов приводятся к стандартному виду. В разделе 2 выводится уравнение типа Гамильтона-ЯкобиБеллмана для задачи со случайной продолжительностью. Раздел 3 содержит некоторые сведения и понятия из математической теории надежности, которые возникают в дифференциальной игре при условии случайной продолжительности игры. Кроме того, будет выбрано распределение Вейбулла, как распределение, описывающее случайную величину, являющуюся моментом окончания игры. В разделе 4 рассматривается конкретный пример дифференциальной игры со случайной продолжительностью, а именно теоретико-игровая модель разработки невозобновляемых ресурсов. 1. Модель игры В дифференциальных играх, как правило, используются два основных подхода к тому, на каком промежутке времени рассматривается игра. Согласно первому подходу, игра развивается во времени на фиксированном временном промежутке [t0, T]: момент окончания игры T известен заранее и игра имеет так называемую предписанную продолжительность [6]. Существуют также подход, имеющий большое число экономических приложений и широко применяющийся на практике, согласно которому игра развивается на бесконечном временном

Управление большими системами. Выпуск 26.1 промежутке [12]. При таком подходе подынтегральная функция полезности игрока (или функция мгновенного выигрыша), как правило, дисконтируется при помощи экспоненциальной функции, однако фактически такая игра не имеет окончания. В данной работе используется другая постановка дифференциальной игры, а именно дифференциальные игры со случайной продолжительностью. Итак, рассмотрим дифференциальную игру n лиц Γ(x0) со случайной продолжительностью T −t0 [8-10] и начальным состоянием x0. Динамика игры задается системой обыкновенных дифференциальных уравнений: Игра начинается в момент t0 из состояния x0, однако, момент ее окончания не фиксирован заранее, а является реализацией некоторой случайной величины T. Будем полагать, что для случайной величины T задана функция распределения F(t), которая опреФункцию «мгновенного» выигрыша игрока i в момент вречто hi(·) являются непрерывными функциями на Rm. Тогда ожидаемый интегральный выигрыш игрока i имеет вид: Z t Пусть игра развивается во времени, тогда в некоторый про-

Управление в медико-биологических и экологических системах в подыгру Γ(x(ϑ)) с начальным состоянием x(ϑ) = x. Очевидно, что игра может и закончиться до момента ϑ с вероятностью F(ϑ), а вероятность продолжить игру после момента ϑ равна Тогда ожидаемый интегральный выигрыш игрока i вычисляется по формуле Z t где Fϑ(t), t ⩾ϑ – это функция распределения момента окончания игры в подыгре Γ(x(ϑ)). Не трудно заметить, что Fϑ(t) является условной функцией распределения, а именно функцией распределения момента окончания игры при условии, что игра мо, чтобы Fϑ(t) удовлетворяла стандартному условию нормировстационарные процессы. Тогда условная функция распределения Fϑ(t) вычисляется по следующей формуле: Далее мы будем предполагать существование плотности распределения момента окончания игры f(t) = F ′(t). Очевидно, что в подыгре Γ(x(ϑ)) условная плотность распределения fϑ(t) определяется следующим образом: Таким образом, при предположении о существовании плотности f(t) = F ′(t) и учитывая равенства (3) и (5), получаем интегральный выигрыш игрока i, i = 1, . . . , n, в подыгре Γ(x(ϑ)): Z t

Управление большими системами. Выпуск 26.1 1.1. ПЕРЕСТАНОВКА ИНТЕГРАЛОВ В ИНТЕГРАЛЬНОМ ФУНКЦИОНАЛЕ Рассмотрим интегральный выигрыш игрока i, который имеет вид (6). Не умаляя общности, в этом разделе положим t0 = 0. Кроме того, введем более компактное обозначение hi(τ) = hi(x(τ)). Итак, рассмотрим интегральный функционал Z t Введем кусочную функцию a(t, τ) следующим образом: Если функция a(t, τ) ⩾0 неотрицательно определена, то можно использовать теорему Тонелли [2,3] о перестановке интегралов в повторном интеграле. Тогда справедливо следующее равенство: dt Z t dt ZZ Если же нельзя гарантировать a(t, τ) ⩾0 (а, фактически, неотрицательность функции мгновенного выигрыша hi(τ)), но

Управление в медико-биологических и экологических системах при этом выполнено условие абсолютной сходимости кратного интеграла ZZ то можно использовать теорему Фубини [2,3] и также изменить порядок интегрирования. Следовательно, при некоторых стандартных ограничениях на функцию hi(·) мгновенного выигрыша игрока i, интегральный функционал, соответствующий ожидаемому интегральному выигрышу игрока i в игре Γ(x0) может быть приведен к стандартному виду для динамического программирования: Z t Аналогично, для выигрыша игрока i в подыгре Γ(x(ϑ)) справедливо следующее представление: Z t Таким образом, нестандартный для динамического программирования функционал, а именно функционал с повторным интегрированием (6), был приведен к стандартному виду (7) при помощи замены порядка интегрирования.

Управление большими системами. Выпуск 26.1 2. Уравнение Гамильтона-Якоби-Беллмана Рассмотрим кооперативную форму игры Γ(x0). Перед началом игры игроки договариваются об использовании ими таких допустимых программных управлений, которые будут максимизировать совокупный ожидаемый выигрыш игроков: n(t)}, доставляющие максимум (8), бущую оптимальным управлениям, – условно-оптимальной. Очевидно, что при непрерывности функций hi в (8) знак суммирования можно перенести в подынтегральную функцию: Обозначим nP hi(x(τ)) как L(x, τ). В общем случае будем рассматривать L(x, u, τ). Для нахождения оптимальных управлений можно использовать и принцип максимума Понтрягина, и уравнение ГамильтонаЯкоби-Беллмана. В данной работе используется второй подход, поскольку новое уравнение Гамильтона-Якоби-Беллмана можно будет использовать не только для нахождения оптимальных управлений, но и для нахождения других решений в управлениях с обратной связью для кооперативного и некооперативного вариантов игры.

Управление в медико-биологических и экологических системах Итак, рассмотрим следующую задачу максимизации: Пусть W(x, t) – это функция Беллмана для данной оптимизационной задачи. Кроме того, рассмотрим другую задачу максимизации, которая отличается от сформулированной выше только отсутствием множителя 1−F(t) перед интегральным функционалом: Обозначим как ¯W(x, t) функцию Беллмана для этой задачи. Очевидно, что справедливо следующее равенство: Тогда частные производные от функции ¯W по ее аргументам вычисляются по следующим формулам: Для задачи динамического программирования (10) для функции Беллмана ¯W мы имеем стандартное уравнение ГамильтонаЯкоби-Беллмана [12]:

Управление большими системами. Выпуск 26.1 Используя (11), (12), (13), из уравнения (14) получаем уравнение Гамильтона - Якоби - Беллмана для задачи (9) со случайным моментом окончания игры: Уравнение типа Гамильтона-Якоби-Беллмана для дифференциальной игры со случайной продолжительностью впервые было выведено в работе Л.А. Петросяна, Н.В. Мурзова [7] в 1966 году для частного случая дифференциальной игры преследования с терминальными выигрышами. Позднее в диссертационной работе Е.В. Шевкопляс [9,10] в 2004 году было напрямую получено уравнение (15) в общей постановке дифференциальной игры со случайной продолжительностью и интегральными выигрышами без предварительного приведения интегрального функционала к стандартному виду. Кроме того, независимо уравнение (15) было получено и другими авторами различными способами. Как будет показано ниже в разделе 4.3, интегральный функционал, соответствующий выигрышу игрока для случая игры со случайной продолжительностью, приведенный к стандартному виду, эквивалентен функционалу, соответствующему выигрышу игрока в задаче с непостоянным дисконтированием мгновенного выигрыша на бесконечном временном промежутке [11,15,16]. В неигровой постановке задачи страхования жизни с рекурсивным дисконтированием функции полезности Ф.Р. Чангом в 2004 году [11] также было выведено уравнение (15) в форме (19) . Независимо от работ Чанга, уравнение Гамильтона-Якоби-Беллмана (15) в форме (19) для теоретико-игровых моделей, в которых функции полезности игроков дисконтируются при помощи функции e− R t to λ(τ)dτ, было получено в работах [15,16] в 2007-2009 годах для нахождения так называемых предварительных соглашений для агентов. Заметим, что если случайная величина T распределена по

Управление в медико-биологических и экологических системах экспоненциальному закону, а именно то интегральный выигрыш Ki(·) игрока i эквивалентен интегральному выигрышу игрока i в игре, рассматриваемой на бесконечном временном промежутке и дисконтированием со ставкой λ мгновенных выигрышей игроков: Полученное уравнение Гамильтона-Якоби-Беллмана, таким образом, для случая с экспоненциальным распределением момента окончания игры, должно сводиться к известному уравнению для игры с дисконтированными мгновенными выигрышами (или функциями полезности в терминологии зарубежной литературы по теории игр) [12]. Легко проверить, что при вое уравнение типа Гамильтона-Якоби-Беллмана (15) принимает вид уравнения Гамильтона-Якоби-Беллмана (16) для игры с дисконтированными мгновенными выигрышами, опубликованного в работе [12] в 2000 году: Таким образом, задача со случайной продолжительностью с экспоненциальным законом распределения T и стандартная задача с

Управление большими системами. Выпуск 26.1 дисконтированными мгновенными выигрышами являются эквивалентными. Этот факт ранее был отмечен в работе A. Haurie [13] для другой постановки задачи со случайной продолжительностью игры, а именно игры конфликта поколений, имеющих случайную продолжительность существования. 3. Вероятностные распределения для момента окончания игры Заметим, что множитель 1−F(ϑ), появившийся в левой части уравнения Гамильтона-Якоби-Беллмана (15), является стандартной для теории надежности функцией интенсивности отказов λ(t) [1, 4, 14 ]. В математической теории надежности одной из важнейших изучаемых случайных величин является время T отказа системы элементов, а функция интенсивности отказов λ(t) (или функция угрозы) – одна из основных ее характеристик. Таким образом, можно провести аналогию между теорией игр, в которой игроки, как элементы системы, взаимодействуют между собой в некотором процессе, разворачивающимся во времени, и математической теорией надежности. Мы рассматриваем игры со случайным моментом окончания T, к которым можно непосредственно применить основную терминологию из математической теории надежности. 3.1. ФУНКЦИЯ ИНТЕНСИВНОСТИ ОТКАЗОВ Итак, функция интенсивности отказов или функция угрозы, определяется следующим образом: Фактически, функция интенсивности отказов является условной плотность распределения, т. е. плотностью распределения при условии, что система не отказала до момента t, в нашей же терминологии – плотностью распределения момента окончания игры при условии, что игра не закончилась до момента t. Стандартными обозначениями являются λ(t) или h(t), далее будем

Управление в медико-биологических и экологических системах использовать обозначение λ(t). Функция интенсивности отказов λ(t), описывающая жизненный цикл системы, имеет следующий вид: Первая фаза называется фазой приработки и отказы в ней, согласно теории надежности, возникают за счет невыявленных перед началом эксплуатации скрытых дефектов [4]. Специфика этой проблемы понятна и не только с точки зрения приложения к техническим системам элементов, не зря в теории надежности в англоязычной литературе для данного периода используется такая терминология как «новорожденный период», «детская смертность» и «ранние отказы». С точки зрения теории игр, ранние отказы могут быть вызваны неопытностью, несогласованностью и не налаженной деятельностью игроков, только что вступивших в игру. Функция интенсивности отказов λ(t) в данной фазе является убывающей функцией времени. Следующим периодом жизненного цикла системы является так называемый период нормальной эксплуатации системы. Функция интенсивности отказов λ(t) в этом периоде постоянна (либо постоянна в приближении), а сами внезапные отказы вызваны несовершенством самой системы и обусловлены, как правило, внешними причинами. В англоязычной терминологии этот период называется «взрослым» периодом [14]. Игра в рассматриваемом периоде может прекратиться под воздействием каких-то непредусмотренных обстоятельств внешнего мира, в частности, в экономических приложениях – под воздействием дефолта, кризиса или других серьезных причин.

Управление большими системами. Выпуск 26.1 После периода нормальной эксплуатации, система переходит в фазу старения. Отказы системы в этом периоде связаны с износом и старением элементов системы, а функция интенсивности отказов λ(t) является возрастающей функцией. Очевидно, что этому факту нетрудно дать интерпретацию в игре – наступает износ технической и инструментальной базы игроков (например, в игре разработки природных ресурсов оборудование подвергается износу). Кроме того, сами соглашения, заключенные перед началом игры, в общем случае не являются реализуемыми в долгосрочных проектах. Этот факт, впервые отмеченный в работе Л.А. Петросяна в 1977 году [5,6] и названный динамической неустойчивостью решений, в англоязычной литературе получил название несостоятельности во времени. Таким образом, можно заключить, что сами соглашения игроков, заключенные перед началом игры, тоже в некотором смысле подвергаются старению и износу. Отметим, что функция интенсивности отказов является константой тогда и только тогда, когда случайное время отказа системы T подчинено экспоненциальному закону распределения, т. е. только при Таким образом, только при экспоненциальном распределении случайной величины T выведенное уравнение ГамильтонаЯкоби- Беллмана (15) сводится к более простому уравнению (16). 3.2. ВЫБОР РАСПРЕДЕЛЕНИЯ ДЛЯ МОМЕНТА ОКОНЧАНИЯ ИГРЫ В математической теории надежности для случайной величины T (момента отказа системы технических элементов) используются различные вероятностные распределения, а именно

Управление в медико-биологических и экологических системах экспоненциальное, Вейбулла, нормальное, логарифмически нормальное, Гамма-распределение и другие [4, 14]. В актуарной математике, а также в геронтологии (науке о продолжительности жизни), для времени существования биологических систем также замечены некоторые закономерности, при этом основными законами являются закон Гомперца-Мейкема и закон Вейбулла [1]. Поскольку в данной статье игра может быть интерпретирована как сочетание различных взаимодействий (как на биологическом, так и техническом уровне), то распределение Вейбулла, используемое для описания продолжительности существования как технических, так и биологических систем, представляется наиболее адекватным распределением для случайного момента окончания игры. Вейбулла Распределение Вейбулла имеет функцию интенсивности отказов следующего вида [4]: Здесь λ и δ – параметры, определяющие данное распределение. λ – это параметр масштаба , а параметр формы δ соответ-

Управление большими системами. Выпуск 26.1 ствует одной из трех фаз, в которой может находиться система (в данном контексте игра). Значение δ < 1 соответствует «новорожденному» периоду, здесь функция интенсивности отказов λ(t) является убывающей функцией. При δ = 1 система находится в режиме нормальной эксплуатации, λ(t) равна константе λ. Отметим, что при δ = 1 распределение Вейбулла соответствует экспоненциальному распределению. При δ > 1 система находится в состоянии износа, λ(t) является возрастающей функцией. Частным случаем распределения Вейбулла для «стареющей» системы является распределение Рэлея, которому соответствует δ = 2. 3.3. УРАВНЕНИЕ ГАМИЛЬТОНА-ЯКОБИ-БЕЛЛМАНА ДЛЯ ДИФФЕРЕНЦИАЛЬНОЙ ИГРЫ СО СЛУЧАЙНЫМ МОМЕНТОМ ОКОНЧАНИЯ, РАСПРЕДЕЛЕННЫМ ПО ЗАКОНУ ВЕЙБУЛЛА Согласно определению функции интенсивности отказов λ(t) (), выведенное в разделе 3 уравнение Гамильтона-ЯкобиБеллмана (15) может быть переписано в следующем виде: Как было сказано выше в разделе 4.1 функция λ(t) для экспоненциального распределения является константой, а именно λ(t) = λ. Следовательно, для экспоненциального распределения момента окончания игры из уравнения (19) непосредственно следует стандартное уравнение Гамильтона-Якоби-Беллмана [12] для игр с дисконтированными мгновеннными выигрышами (16). Кроме того, отметим, что уравнение (19) имеет тот же вид, что и уравнение Гамильтона-Якоби-Беллмана для игр с непостоянными дисконтированными мгновенными выигрышами, а именно, когда дисконтирование выигрыша hi производится при помощи умножения его на e− R τ t0 λ(t)dt [15,16]. Это непосредственно следует из того, что в приведенном к стандартному виду функционале (6) при помощи функции интенсивности отказов λ(t) (17),

Управление в медико-биологических и экологических системах выражение (1 −F(τ)) путем несложных преобразований можно записать как (1 −F(τ)) = e− R τ Пусть момент окончания игры T распределен по закону Вейбулла. Тогда функция интенсивности отказов λ(t) вычисляется по формуле (18). Следовательно, уравнение (19) Гамильтона-ЯкобиБеллмана принимает следующий вид: Очевидно, что при значении δ = 1, которое соответствует экспоненциальному распределению, уравнение (20) принимает стандартный вид (16). 4. Пример В качестве примера рассмотрим теоретико-игровую модель разработки невозобновляемых ресурсов симметричными игроками, опубликованную в работе [12]. Однако в данной работе будем предполагать, что мгновенные выигрыши игроков не дисконтируются и, кроме того, игра заканчивается в случайный момент времени T, распределенный по закону Вейбулла. Итак, согласно модели [12], в игре участвуют n игроков – фирмы или страны, которые разрабатывают некоторый невозобновляемый природный ресурс, например, нефть. Множество всех игроков обозначим как I = {1, 2, ..., n}. Пусть x(t) – это поток невозобновляемого ресурса. Управлениями игроков являются темпы разработки ресурса, которые обозначим как {ci(t)}. Динамика изменений потока ресурса x(t) описывается следующим дифференциальным урав-

Управление большими системами. Выпуск 26.1 нением: lim Каждый игрок i имеет функцию полезности (функцию мгновенного выигрыша) h(ci), определенную для всех ci > 0. Рассмотрим только логарифмический вид функции полезности игрока: Пусть игра начинается в момент времени t0 = 0, заканчивается в момент времени T, который является случайной величиной, распределенной по закону Вейбулла. Тогда ожидаемый выигрыш игрока i имеет следующий вид: Z t Согласно разделу 2.1, интегральный выигрыш (22) можно представить в виде (7). Для распределения Вейбулла (1−F(t)) = e−λtδ [4], следовательно, интегральный выигрыш игрока i вычисляется по следующей формуле: Тогда общий ожидаемый выигрыш игроков вычисляется по формуле

Управление в медико-биологических и экологических системах Пусть V (N, x0) – максимальное значение общего ожидаемого выигрыша в игре Γ(x0). Очевидно, что в данной модели рассматриваются только симметричные игроки, поэтому положим ci = cj = c. Кроме того, на данном этапе представляется возможным найти решение для произвольного распределения с функцией интенсивности отказов λ(t). Итак, согласно (19) имеем уравнение Гамильтона-ЯкобиБеллмана следующего вида: Будем искать решение уравнения (24) в виде W(x, t) = A(t)lnx+ B(t). Тогда частные производные W(x, t) вычисляются по формуле Учитывая (25), из условия максимизации правой части уравнения (24) следует, что оптимальные управления имеют вид c = x A. Применяя метод неопределенных коэффициентов в уравнении (24), получаем следующую систему уравнений для коэффициентов A(t), B(t): Окончательно имеем следующие оптимальные управления для задачи разработки невозобновляемых ресурсов со случайной продолжительностью:

Управление большими системами. Выпуск 26.1 Предположим, что случайный момент окончания разработки ресурсов подчинен закону Вейбулла. Тогда функция λ(t) имеет вид (18). Тогда при δ = 1, соответствующем экспоненциальному распределению момента окончания игры, фактически рассматривается уже изученная модель с дисконтированными выигрышами на бесконечном временном промежутке. Непосредственно из (26) следует, что при δ = 1 оптимальными стратегиями игроков являются Тогда оптимальные управления и траектория вычисляются по формуле Этот результат совпадает с результатом, полученным в работе Докнера и др. [12] для случая дисконтированных выигрышей на бесконечном временном промежутке для единичной эластичности маргинальной полезности игроков. Отметим, что траектория чаем следующее значение общего ожидаемого выигрыша: Далее, для δ = 2, соответствующем распределению Рэлея для стареющей системы, из (26) получаем

Управление в медико-биологических и экологических системах Тогда оптимальный способ поведения при разработки ресурса должен определяться согласно следующей формуле где Z t Φ0(t) −интегральная функция Лапласа. Для периода приработки (раннего периода) возьмем δ = 1 Тогда из уравнения (26) получаем Следовательно, получаем оптимальные стратегии в управлениях с обратной связью: Таким образом, для модели разработки невозобновляемых ресурсов удалось получить оптимальные решения для всех трех фаз игры. Анализ полученных решений может являться предметом дальнейшего изучения.

Управление большими системами. Выпуск 26.1 5. Благодарности Данное исследование было инициировано профессором Л.А. Петросяном в 1998 году. Кроме того, автор выражает благодарность профессору Дж. Заккуру и господину Д. Громову за информационную помощь во время ознакомления с проблематикой задачи. Ценные замечания и комментарии из области математического анализа и теории оптимального управления во время подготовки статьи были высказаны доцентом Д.С. Челкаком и профессором Дж. Марин-Солано.