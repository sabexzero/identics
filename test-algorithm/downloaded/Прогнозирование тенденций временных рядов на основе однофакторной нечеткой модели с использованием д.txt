Введение А нализ временных рядов играет важную роль в решении многих актуальных задач, напри мер, при краткосрочном прогнозировании тенденций рынка труда в России. В настоящее вре мя существует необходимость в разработке методов прогнозирования, которые бы обеспечили получе ние адекватной оценки предстоящих изменений политики и принятия решений в региональных ор ганах управления на основе известных показателей развития регионов. Так как большинство реальных событий характеризуются некоторой неопределен ностью, то каждому наблюдению временного ряда (фактора) можно поставить в соответствие нечет кую переменную с некоторой функцией принад лежности. Модель прогнозирования на основе нечетких мно5 жеств первого типа Нечеткие временные ряды могут быть представ лены с помощью нечетких множеств первого или второго типа [1, 2, 3]. Дискретное нечеткое множество первого типа (ДНМТ1) A, определенное на универсуме может быть определено в виде: где fA(u) – функция принадлежности ДНМТ1 A, надлежности элемента ur ДНМТ1 A, r = 1,n Пусть Y(t) (t = ..., 0, 1, 2, ...) – универсум, опре деленный на множестве действительных чисел, а F(t) – набор функций f(t) (i = 1, 2, ...)), определен ных на универсуме Y(t). Тогда F(t) называется не четким временным рядом на универсуме Y(t). Пусть где R(t, t–1) – нечеткое отношение и ° – операция max%min композиции. Обозначим зависимость F(t) от F(t–1) как ПРОГНОЗИРОВАНИЕ ТЕНДЕНЦИЙ ВРЕМЕННЫХ РЯДОВ НА ОСНОВЕ ОДНОФАКТОРНОЙ НЕЧЕТКОЙ МОДЕЛИ С ИСПОЛЬЗОВАНИЕМ ДИСКРЕТНЫХ НЕЧЕТКИХ МНОЖЕСТВ ВТОРОГО ТИПА И ГЕНЕТИЧЕСКОГО АЛГОРИТМА МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ БИЗНЕС-ИНФОРМАТИКИ Л.А. Демидова, к.т.н., доцент кафедры вычислительной и прикладной математики Рязанского государственного радиотехнического университета, Рассматривается применение дискретных нечетких множеств второго типа для разработки однофакторных нечетких моделей прогнозирования. Предлагается генети" ческий алгоритм, обеспечивающий выбор оптимальных параметров модели прогнозиро" вания – действительных чисел для корректировки границ универсума, числа интервалов разбиения универсума и степеней принадлежности элементов дискретных нечетких множеств второго типа. БИЗНЕС-ИНФОРМАТИКА №4(06)–2008 г.

МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ БИЗНЕС-ИНФОРМАТИКИ Если F(t) зависит от F(t–1), F(t–2),…, F(t–k), то не четкая логическая зависимость представляется как: факторной kпорядковой моделью прогнозирова ния на основе нечетких временных рядов. Рассмотрим модель прогнозирования при k = 1. Представим нечеткие данные iго и (i+1)го пе риодов (дней, месяцев, кварталов и т.п.) как нечет кие множества Aj и Ak на универсуме U. Тогда нечет кая логическая зависимость может быть представле следующее состояние нечеткой зависимости. Пусть fi(t) = T, (i = 1, 2, ...) – реальные значения временного ряда для некоторого фактора. Опреде лим универсум U для приращений значений факто ра как U = [Dmin–D1, Dmax + D2], где Dmin и Dmax – минимальное и максимальное приращения значе ний фактора на основе известных данных соответ ственно (Dmin = min(f (t)–f (t–1), Dmax = max(f (t)–f (t–1)), а D1 и D2 – два действительных числа, обес печивающие разбиение универсума U на интерва лы равной длины: u1, u2, …, un [1, 2]. Лингвистичес кие термы Ar (r = 1, n ——–), представленные нечеткими множествами фактора, имеют вид: Если значение приращения фактора принадле жит интервалу u1, то соответствующее нечеткое зна чение имеет вид: Xn = 1/A1 + 0,5A2. Если значение приращения фактора принадлежит интервалу ur, то соответствующее нечеткое значение имеет вид: ———— . Если значе ние приращения фактора принадлежит интервалу un, то нечеткое значение имеет вид: Xn = 0,5/An1 + 1An . Пусть Xk и Xj – нечеткие значения приращения для iго и (i + 1)го периодов соответственно. Для iго периода можно записать нечеткую логическую за симостей для всех известных значений временного ряда определяются группы зависимостей путем объединения зависимостей с одинаковой левой час ция принадлежности ДНМТ1 группы определяется как Результирующее ДНМТ1 для прогнозируемого значения временного ряда для (i+1)го периода на ходится как объединение ДНМТ1, входящих в пра вую часть группы нечетких зависимостей для iго периода [1, 2]. Искомое значение прогнозируемой величины находится как сумма реального значения времен ного ряда фактора Ti для iго периода и дефаззифи цированного (четкого) значения приращения фак тора yi+1: Четкое значение приращения фактора для (i+1)го периода находится по методу центра тяжести для одноточечных множеств где n – количество интервалов ur (r = (r = 1,n zr – средняя точка rго интервала; wr – значение степени принадлежности для rго интервала результирующего ДНМТ1, описываю щего группу нечетких зависимостей. Средняя относительная ошибка прогноза (AFER – average forecasting error rate) может быть вычислена по формуле: где Fi и Ti – предсказанное и реальное значения для iго периода; m – количество значений (периодов) времен ного ряда. Модель прогнозирования на основе нечетких множеств второго типа Нечеткие множества второго типа позволяют моделировать различные неопределенности, кото рые не могут быть адекватно представлены с помо щью нечетких множеств первого типа [3]. Однако применение нечетких множеств второго типа обыч но увеличивает вычислительную сложность по сравнению с нечеткими множествами первого типа изза наличия дополнительной размерности. По этому, использование нечетких множеств второго типа является целесообразным, если позволяет обеспечить значительное улучшение результатов (например, повышение точности прогноза). Интервальное дискретное нечеткое множество второго типа (ИДНМТ2) A~, определенное на уни версуме U может быть определено в виде [3]: БИЗНЕС-ИНФОРМАТИКА №4(06)–2008 г.

МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ БИЗНЕС-ИНФОРМАТИКИ где fA~(u) = μ–A~(u), μ A~(u) – «нижняя» и «верхняя» функции принадлежности ИДНМТ2, являющиеся функциями принадлежности ДНМТ1, характеризующие «отпечаток неопре деленности» (footprint of uncertainty) FOU [3]; ——–) – степень принад лежности элемента ur по «нижней» и «верхней» функциям принадлежности ИДНМТ2. Серым цветом закрашен сам FOU, символы ° и • определяют дискретные значения для «нижней» и «верхней» функций принадлежности ИДНМТ2 соответственно (при совпадении значений для «нижней» и «верхней» функций принадлежности символ • изображен внутри символа °). фактора для iго и (i+1)периодов соответственно. Тогда для iго периода можно записать нечеткую пы нечетких зависимостей определяются путем объединения нечетких зависимостей с одинаковой левой частью в одну группу. Если были сформиро и «верхняя» функции принадлежности ДНМТ1, ха рактеризующие группу, определяются как Результирующие ДНМТ1 для прогнозируемого значения (i+1)го периода находятся как объедине ния ДНМТ1, соответствующих «нижней» и «верх ней» функциям принадлежности, для FOU, входя щих в правую часть группы нечетких зависимостей для iго периода. Таким образом, для каждого про гнозируемого значения (i+1)го периода временно го ряда находится соответствующие ему ИДНМТ2 и FOU – выходной «отпечаток неопределенности». Искомое значение прогнозируемой величины находится как сумма реального значения времен ного ряда (фактора) Ti для iго периода и дефаззи фицированного (четкого) значения приращения фактора yi+1 по формуле (3). Четкое значение приращения фактора (центро ид) для (i+1)го периода находится с помощью опе рации «typereduction» (операции «понижения ти па») [3]. При этом определяют два «вложенных» не четких множества первого типа – L и R – внутри FOU интервального нечеткого множества второго типа A ~. Множества L и R имеют минимально и мак симально возможный центроиды в A ~ соответствен но. Результирующее четкое значение центроида оп ределяется как среднее значение от центроидов множеств L и R. ИДНМТ2 может быть представлено интервалом определения, который описывается с помощью его левой и правой конечных точек как [yleft, yright] соот ветствующих множествам L и R, или с помощью его центра и протяженности как [c–s, c + s], где Центроид ДНМТ1 представляет собой взвешен ное среднее по формуле (4). Для вычисления цент роида ИДНМТ2 CA~ необходимо представить wr (значение степени принадлежности для rго интер вала результирующего ДНМТ1 в формуле (4)) как ДНМТ1. Центроид CA~ определяется через центро иды всех «вложенных» в FOU ДНМТ1 и может быть представлен как: БИЗНЕС-ИНФОРМАТИКА №4(06)–2008 г. Лингвистические термы A ——–) на основе ИДНМТ2 могут быть определены в виде: где V = αlower, αupper; αlower и αupper – значения «ниж ней» функций принадлежности μ–A~(u) и «верх ней» функций принадлежности μ– A~(u) в точке ur Таким образом, каждому лингвистическому тер му A r соответствует некоторый FOU, границы кото рого определяются с помощью «нижней» и «верх ней» функций принадлежности μ–A~(u), μ– Модель прогнозирования на основе ИДНМТ2 строится аналогично модели на основе ДНМТ1. Пусть определены FOUk и FOUj для приращений

МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ БИЗНЕС-ИНФОРМАТИКИ где Zr (r = 1,n ——–) в (7) представляет собой ДНМТ1, ——–) представляет собой ДНМТ1, имеющее Так как Z1, …, Zn, W1, …, Wn представляют собой ДНМТ1, то и CA~ является ДНМТ1. Для вычисле ния центроида CA~ необходимо найти две конечные точки интервала: yleft и yright и , рассмотрев задачи минимизации и максимизации функции (положив zr = cr + sr и zr = cr – sr соответственно) [3]: Продифференцируем функцию y(w1,...,wn) по wk: Так как то из (9) следует, что: Так как из y(w1,...,wn) = zk следует, что Из (10) видно, что если zk > y(w1,...,wn), то y(w1,...,wn) увеличивается при увеличении wk; а если zk < y(w1,...,wn), то y(w1,...,wn) уменьшается при уменьшении wk. Для вычисления центроида CA~ можно использовать итерационный алгоритм Кар никаМенделя [3]. Итерационный алгоритм Карника5Менделя ——– . Макси мальное (минимальное) значение, которое может принимать wk (k =1,n ——–), равно hk +Δk (hk–Δk). Функция y(w1,...,wn) достигает своего макси мального значения, если: ✧ wk = hk +Δk для тех значений k, для которых ✧ wk = hk–Δk для тех значений k, для которых Функция y(w1,...,wn) достигает своего минималь ного значения, если: ✧ wk = hk–Δk для тех значений k, для которых ✧ wk = hk + Δk для тех значений k, для которых Максимум функции y(w1,...,wn) может быть оп ределен с помощью следующей итерационной про цедуры. Пусть zr = cr + sr, (r = 1,n ——–). Предположим, что все zr упорядочены по возрастанию, то есть 1. Пусть wr = hr для r =1,n ——–. Вычислим y’= y(h1,...,hn) по формуле (8). Δk+1,...,hn+Δn) по формуле (8). Так как все zr упоря дочены по возрастанию, с учетом формул (10) и (11) 4. Если y’ = y’’, то вычисления заканчиваются, а представляет собой максимум функции шагу 5. 5. Полагаем y’ = y’’ и осуществляем переход к шагу 2. Алгоритм требует не более n итераций, где одна итерация состоит из шагов 2–5 [3]. Минимум функции y(w1,...,wn) может быть опре делен с помощью аналогичной итерационной про цедуры, где zr = cr + sr, (r =1,n ——–); а на Шаге 3 для вы числения y’’ = y(h1+Δ1,...,hk+Δk, hk+1–Δk+1,...,hn+Δn) Генетический алгоритм, обеспечивающий повышение точности прогнозирования на основе нечетких множеств второго типа Самостоятельной задачей при прогнозировании на основе нечетких временных рядов является оп ределение оптимальных параметров модели, обес печивающих максимальную точность прогнозиро вания: действительных чисел D1, D2, используемых при корректировке универсума U, количества ин тервалов разбиения D3 = n универсума U и степеней принадлежности элементов D4 (αupper), D5 (αlower) для ИДНМТ2. Применение генетического алгорит ма (ГА) позволяет значительно сократить время БИЗНЕС-ИНФОРМАТИКА №4(06)–2008 г.

МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ БИЗНЕС-ИНФОРМАТИКИ поиска оптимальных значений параметров D1, D2, D3, D4, D5 [5]. При этом хромосома s будет иметь вид: s = (D1, D2, D3, D4, D5). Для каждого элемента хромо сомы следует задать диапазоны их изменения: для D1 – [–d1; 0], для D2 – [0; d2], для D3 = n–[2; nmax], для D4, D5 – [0; 1], где d1, d2, – положительные действи тельные числа, равные, например, di = Dmax–Dmin, личество значений временного ряда). Также при формировании начальной популяции, при выпол нении операций скрещивания и мутации необходи как элементы D4, D5,, в хромосоме определяют верхнее и нижнее значение функций принадлежно сти ИДНМТ2 соответственно. Для каждого набора параметров D1, D2, D3, D4, и D1, D2, D3, D5 необходимо вычислить функцию соответствия. В качестве функции соответствия можно выбрать функцию (5). Однако при вычисле нии функции соответствия по формуле (5) для хро мосом как начальной популяции размера P, так и расширенной популяции размера (P +P*Pc) (где Pc – коэффициент скрещивания) может быть получено значение вида «0/0» (если имеются группы нечет ких зависимостей с неопределенными правыми ча стями, и поэтому невозможно вычислить прогноз ное значение по формулам (3), (4), так как значение приращения фактора yi+1 определяется как «0/0»). Поэтому при удалении из популяции размером (P + P*Pc) хромосом с худшими значениями функ ций соответствия следует предварительно оценить хромосомы со значением функции соответствия «0/0» как наихудшие (например, таким хромосомам можно поставить в соответствие максимально воз можное значение ошибки, равное 100%). При сор тировке хромосом по возрастанию значений функ ций соответствия хромосомы со значением функ ции соответствия, равным «0/0», будут занимать последние места в списке и в результате отбраковки P*Pc худших хромосом будут исключаться из попу ляции [1]. Для обеспечения гарантированного вы полнения прогноза следующего значения времен ного ряда необходимо видоизменить функцию со ответствия в ГА следующим образом. Если для каж дого набора D1, D2, D3, D4, и D1, D2, D3, D5 некоторой хромосомы s определены все правые части групп нечетких зависимостей, то функция соответствия для этих наборов вычисляется по формуле (5). Если для любого из наборов D1, D2, D3, D4, и D1, D2, D3, D5 не определена хотя бы одна правая часть в группах нечетких зависимостей, то значение функции соот ветствия находится как сумма средней относитель ной ошибки прогноза по формуле (5) и числа 100. Таким образом, видоизмененная функция соот ветствия имеет вид: где AFER определяется по формуле (5), V = αlower, В результате, набор D1, D2, D3, D4 или D1, D2, D3, D5, несмотря на то, что для него средняя относи тельная ошибка прогноза по формуле (5) может быть минимальной (если значение функции соот ветствия не определяется как «0/0»), будет признан одним из худших в процессе реализации ГА, и, воз можно, соответствующая ему хромосома будет ис ключена из популяции. На основе наборов D1, D2, D3, D4 и D1, D2, D3, D5, вычисляются два значения функций соответствия Jαupper и Jαlower. Если хотя бы для одного из наборов значение функции соответствия оказалось больше 100, то соответствующую ему хромосому следует признать «нежизнеспособной» и положить значе ние ее функции соответствия Js равным наиболь шему из двух значений функций соответствия на боров D1, D2, D3, D4 и D1, D2, D3, D5. При этом нет необходимости в вычислении функции соответ ствия для хромосомы с использованием алгоритма КарникаМенделя для определения центроида ИДНМТ2. В противном случае для хромосомы s вычисляется средняя относительная ошибка про гнозирования AFER по формуле (5) с использова нием алгоритма КарникаМенделя для определе ния центроида ИДНМТ2. Если значение AFER для s (и ИДНМТ2) окажется меньше, чем значения функций соответствия Jαupper и Jαlower и для наборов D1, D2, D3, D4 и D1, D2, D3, D5 соответственно, то та кую хромосому следует считать «жизнеспособной», а значение ее функции соответствия Js положить равным AFER, иначе необходимо положить значе ние ее функции соответствия Js равным AFER + 100 (для возможного исключения этой хромосомы из популяции). Таким образом, функцию соответ ствия хромосомы s следует вычислять по формуле: Отметим, что необходимо затратить дополнитель ное время на формирование начальной популяции, чтобы она состояла только из «жизнеспособных» БИЗНЕС-ИНФОРМАТИКА №4(06)–2008 г.

МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ БИЗНЕС-ИНФОРМАТИКИ хромосом (у которых значение функции соответ ствия меньше 100). Тогда выполнение операций скрещивания и мутации будет более эффективным и результативным (иначе вся популяция может быть с самого начала «нежизнеспособной»). Хро мосома, минимизирующая функцию (13), имеет больше шансов быть признанной лучшей. Выбор родителя будет состоять в выборе лучшей хромосо мы из двух случайно выбранных. Затем две выбран ные таким образом хромосомыродителя использу ются для скрещивания, при этом выбирается коэф фициент скрещивания Rc и генерируется число Nc = rahdom([0, 1)]. Если Rc > Nc, то случайным об разом выбирается точка скрещивания z и выполня ется скрещивание. При выполнении мутации вы бирается коэффициент мутации Rm и генерируется число Nm = rahdom([0, 1)]. Если Rm > Nm, то случай ным образом выбирается точка мутации z. Тогда генетический алгоритм имеет вид: 1. Создается начальная популяция размера P из случайным образом выбранных хромосом s. 2. При g < G (G – количество генераций) вычис ляется функция соответствия для каждой хромосо мы, затем создается P/2 пар хромосомродителей и осуществляется переход к шагу 3. При g > G осу ществляется переход к шагу 5. 3. Выполняются операции скрещивания и мута ции для текущей популяции. 4. Создается новая популяция размера P, допол ненная хромосомамидетьми, а хромосомы с худ шими значениями функции соответствия отбрасы ваются. 5. Выбирается лучшая хромосома, которая ми нимизирует функцию соответствия. Пример прогнозирования На примере данных по фактору «численность занятого населения» (в России) для периодов 21999 – 52004, полученных от Госкомстата (табл. 1) была построена нечеткая модель прогнозирования на основе ИДНМТ2. Представление выходных зна чений фактора на основе ИДНМТ2 приведено в табл. 1. При этом были получены группы нечет ких логических зависимостей: В табл. 2 приведены параметры трех однофак торных нечетких моделей и результаты прогнозиро вания. «Модель 1» основана на ДНМТ1 при заранее заданном значении степени принадлежности эле ментов нечеткому множеству . Параметры опреде лялись с помощью ГА. «Модель 2» основана на ДНМТ1. Параметры определялись с помощью ГА. «Модель 3» основана на ИДНМТ2. Параметры оп графические зависимости для реальных и прогно зируемых значений на основе ИННМТ2. Анализ результатов моделирования показывает уменьше ние средней относительной ошибки прогнозирова ния за счет применения ИДНМТ2 (при этом отно сительная ошибка прогнозирования для периода 52004 на основе «Модели 3» равна 1,173505 %). Заключение Предлагаемый метод прогнозирования тенден ций рынка труда обеспечивает получение более вы соких результатов прогноза, чем предложенный в [4], и может быть рекомендован для проведения краткосрочных прогнозов. Применение ИДНМТ2 и ГА для поиска оптимальных параметров нечеткой модели обеспечили более высокую точность про гноза. Для повышения точности прогноза можно представлять значения временных рядов с помо щью непрерывных нечетких множеств второго типа, что приводит, однако, к соответствующему увеличению вычислительной сложности и вре менных затрат. ■ БИЗНЕС-ИНФОРМАТИКА №4(06)–2008 г. мых значений

МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ БИЗНЕС-ИНФОРМАТИКИ БИЗНЕС-ИНФОРМАТИКА №4(06)–2008 г. Таблица 1 Фактор «численность занятого населения» Таблица 2 Параметры нечётких моделей Параметры «Модель 1» «Модель 2» «Модель 3» Месяц-год Фактор, тыс. ч. Приращение, тыс. ч. Входное ИДНМТ2 Выходное ИДНМТ2 (V = αlover, αupper)

МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ БИЗНЕС-ИНФОРМАТИКИ БИЗНЕС-ИНФОРМАТИКА №4(06)–2008 г.