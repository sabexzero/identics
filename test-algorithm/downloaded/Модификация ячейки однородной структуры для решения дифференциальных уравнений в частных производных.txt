Введение В статьях [1, 2] изложены примеры реализации вычислительного устройства для решения диффе ренциальных уравнений в частных производных на основе непрограммируемых ячеек однородной структуры [3], показана возможность его реконфи гурирования в зависимости от области решения и вида граничных условий, с помощью моделиро вания дана оценка выигрыша в производительно сти на данном классе задач по сравнению с уни версальным микропроцессором при прочих рав ных условиях. Подобные устройства с аппаратной реализацией алгоритма на микросхемах типа БМК или ПЛИС находят все большее применение в вы сокопроизводительных вычислениях [4]. В настоящей статье рассмотрено еще одно пре имущество таких ячеек – возможность организа ции параллельного решения дифференциальных уравнений в частных производных с переменными коэффициентами, значения которых могут зави сеть от самой искомой величины. Такие коэффициенты, характеризующие свой ства среды, встречаются при решении реальных физических задач, например тепломассопереноса. Достаточно упомянуть, что один из ведущих про изводителей программного обеспечения для моде лирования сложных инженерных объектов MSC Software Corporation подчеркивает учет температур нозависимых коэффициентов (вязкости, тепло проводности, теплоемкости и др.) в качестве до стоинства своих программных продуктов [5]. В фундаментальном труде [6], посвященном со временным однородным вычислительным структу рам, этот вопрос не рассматривается. Там все по добные коэффициенты относят к константам, ко торые заносятся в регистры ячеек на этапе на стройки поля структуры и во время этапа решения остаются неизменными. Из вычислительной практики известно, что ко эффициенты, зависящие от искомого решения, необходимо многократно пересчитывать и после довательно повторять решение дифференциальных уравнений в частных производных до тех пор, пока отличия в рассчитанных значениях не станут ме нее заданной погрешности. Это значительно уве личивает время решения всей задачи. Объект и цель исследования Объектом исследования является вычислитель ный процесс в ячейке однородной структуры для решения дифференциальных уравнений в частных производных с переменными коэффициентами, зависящими от искомого решения. Целью исследования является модификация вычислительного процесса в ячейке таким обра зом, чтобы получаемое последовательно решение дифференциального уравнения использовалось параллельно для пересчета зависимых от него ко эффициентов, что позволит повысить точность ре шения задачи без увеличения количества итера ций. Модификация схемы ячейки Для достижения поставленной цели в извест ную схему ячейки [1, 2] можно ввести либо допол нительное вычислительное устройство для перес чета и замены коэффициентов, либо дополнитель ный вход для ввода новых значений коэффициен тов, пересчитанных некоторым внешним устрой ством. Первый вариант приведет к существенному усложнения схемы ячейки. Зависимость коэффи циентов дифференциальных уравнений от иско мой переменной может быть различной. Напри мер, теплопроводность твердых тел часто аппрок симируется линейной зависимостью от температу ры, а для расчета коэффициентов теплопроводно сти жидкостей и газов применяют более сложные формулы, полученные путем экспериментальных исследований. Аналогичные зависимости имеют и другие температурнозависимые коэффициен ты [7]. Управление, вычислительная техника и информатика УДК 519.673 МОДИФИКАЦИЯ ЯЧЕЙКИ ОДНОРОДНОЙ СТРУКТУРЫ ДЛЯ РЕШЕНИЯ ДИФФЕРЕНЦИАЛЬНЫХ УРАВНЕНИЙ В ЧАСТНЫХ ПРОИЗВОДНЫХ С ПЕРЕМЕННЫМИ КОЭФФИЦИЕНТАМИ А.А. Хамухин Томский политехнический университет Предложена модификация ячейки однородной структуры для решения дифференциальных уравнений в частных производных с коэффициентами, зависящими от искомой переменной. Показана возможность реализации функционального наполнения ячейки с параллельным пересчетом значений коэффициентов во внешнем устройстве. Представлены результаты моделирова ния линейки ячеек на примере решения тестовой краевой задачи с температурнозависимыми коэффициентами. Ключевые слова: Ячейка однородной вычислительной структуры, параллельные вычисления, дифференциальные уравнения в частных произ водных, переменные коэффициенты.

Этот факт является дополнительным доводом в пользу второго варианта реализации учета зависи мости коэффициента от искомой переменной с по мощью внешнего устройства. Эту функцию может выполнять универсальный микропроцессор, кото рый является необходимой составляющей для упра вления любой однородной вычислительной струк турой [3]. Главными задачами управляющего ми кропроцессора является ввод коэффициентов в ре гистры ячеек однородной структуры перед циклом вычислений и вывод из ячеек полученных резуль татов в конце цикла вычислений. Во время самого рабочего цикла однородной структуры этот микро процессор простаивает и его можно использовать для пересчета коэффициентов. Таким образом, схема ячейки дополняется только устройством для ввода коэффициентов по ходу решения, что несущественно усложнит Ячейка может находиться в двух состояниях, задаваемых внешним устройством управления. Первое состояние – это рабочий цикл вычислений, во время которого сигналы с выходов других ячеек (приращения) умножаются на коэффициенты в БМИ, суммируются в сумматоре СП, передаются в интегратор и при этом формируются выходные сигналы (приращения) для соседних ячеек. По сигналу окончания шага по времени от вне шнего устройства управления ячейка переходит во второе состояние – цикл чтения/записи. Во время этого цикла результат интегрирования передается в блок формирования приращений с предыдущих шагов по времени и используется уже в следующем рабочем цикле ячейки, а также передается во вне шнее устройство. Во время этого цикла в БМИ за писываются новые значения коэффициентов, по лученные от внешнего устройства. Блок масштабных интеграторов БМИ обычно реализуется на сдвиговых регистрах, соединенных через последовательные входы, поэтому запись ко эффициентов во все регистры может быть произве дена через один вход. В этих регистрах хранятся коэффициенты, на которые умножаются входные сигналы БМИ. Количество входов в БМИ необхо димо сделать больше, чем количество выходов со седних ячеек. Подавая на дополнительный вход БМИ логическую единицу, можно реализовать до полнительное слагаемое в правой части дифферен циального уравнения, если в этом будет необходи мость. Это слагаемое будет вычисляться внешним устройством также как и коэффициенты и переда ваться в соответствующий регистр блока масштаб ных интеграторов по сигналу окончания шага по времени через ключевой элемент КЭ2. Известия Томского политехнического университета. 2011. Т. 318. № 5 Модифицированная функциональная схема ячейки однородной структуры для решения дифференциальных уравне ний в частных производных с переменными коэффициентами: 1) блок масштабных интеграторов БМИ; 2) сумматор приращений СП; 3) следящий интегратор СИ; 4) интегратор И; 5) блок формирования приращений с предыдущих ша гов по времени БФПВ; 6,7) ключевые элементы КЭ1, КЭ2 ɋɉ ɋɂ ȻɆɂ Ʉɗ1 xxx xx ɧɚ Ʉɗ2

Пример использования модифицированной ячейки Рассмотрим в качестве примера уравнение те плопроводности (диффузии) с коэффициентом (U,x), характеризующим свойства среды: с начальными и граничными условиями где t – время; U0(x) – начальные значения искомой переменной; G – граница области решения; F(x,t) и FG(t) – функции источника внутри и на границе области решения. Первое слагаемое правой части уравнения (1) будет иметь две составляющие: В работах [1, 2] показано, как реализовать ячей ку однородной структуры для решения уравнения вида: Анализ правой части выражения (4) показал, что в отличие от (5) появляется дополнительное первое слагаемое, а во втором слагаемом коэффи циент  необходимо пересчитывать в зависимости от получаемого решения U. Применение неявной схемы аппроксимации для выражения (4), изло женной в [1, 2], приведет к существенному услож нению функциональной схемы ячейки однородной структуры и потери ее главного достоинства – про стоты реализации. Поэтому в настоящей работе предлагается при менить явнонеявную схему аппроксимации. Эта схема должна быть такой, чтобы на текущем шаге по времени вычислительный процесс в ячейке протекал также, как в аналоге (по неявной схеме). Коэффициент  и первое слагаемое правой части выражения (4) предлагается аппроксимировать по явной схеме. Благодаря этому их расчет можно возложить на некоторое внешнее устройство (на пример, на управляющий микропроцессор, ука занный в работе [2]), которое получает текущее ре шение от ячеек на nом шаге по времени и в про межутке между шагами рассчитывает значение ко эффициента  и первого слагаемого для n+1 шага по времени. В соответствии с предложенной схемой получа ем расчетную формулу для внутренних узлов рав номерной разностной сетки, наложенной на область решения: где t и h – шаги по времени и пространственной координате; n и i – их номера; переменная Ф i,i–1 n,n–1получена путем аппроксимации по явной схеме и ее можно рассматривать для ячейки как модифицированную функцию источника F: Выражение (6) отличается от аналогичного вы ражения в работе [2] только наличием индексов у модифицированной функции источника и у ко эффициента i n. Эти индексы означают, что после каждого шага по времени n значения указанных ве личин нужно вводить в ячейку заново, которые рассчитываются внешним устройством и на n+1 шаге работы ячейки используются как константы. Выполним аналогично работе [2] переход от выражения (6) к формуле, описывающей функ ционирование ячейки однородной структуры. Уч тем, что сам алгоритм работы ячейки с прираще ниями уже содержит внутренний итерационный процесс, который можно использовать для перес чета коэффициентов. Для обеспечения устойчивости решения на каждом шаге по времени применяется метод уста новления (итераций) по фиктивному времени. Для этого все слагаемые конечноразностного уравне ния (6) переносятся в правую часть, а в левой части ноль заменяется производной от искомой пере менной по фиктивному времени : где Далее применяется конечноразностная ап проксимация по явной схеме для аргумента . где […] – правая часть уравнения (7). На первом шаге (n=0) по реальному времени уравнение (8) имеет вид: причем Ui В общем виде уравнение (9) для n+1го шага по реальному времени и для +1 шага по фиктив ному времени: Обмен данными между ячейками однородной структуры производится не полными переменны ми, а их приращениями, выражение для которых легко получить из предыдущего уравнения: n n i i k U k U k U

 

 

i i k U k U k U

 

 

    n n i i k U k U k U    n n i i

n n i i      U x U x U x x G F t     U x Управление, вычислительная техника и информатика

Ур. (10, 11) одинаковы для каждого iго вну треннего узла разностной сетки и могут быть реа лизованы аппаратно в виде ячейки однородной вычислительной структуры. Приближенное реше ние ур. (1) получается в результате совместной ра боты ячейки и внешнего устройства, функцию ко торого может выполнять, как было указано ранее, управляющий микропроцессор. Функциональная схема взаимодействия ячейки и внешнего устрой (сигналы управления опущены). Внутри однородной структуры каждая ячейка передает рассчитанное на каждом шаге прираще ние в соседние ячейки и обрабатывает прираще ния, полученные от соседних ячеек по формуле (11). Одновременно приращения, отражающие из менение искомой переменной U, с выхода каждой ячейки поступают на внешнее устройство, которое параллельно вычисляет новое значение коэффици ента ki n и модифицированную функцию источника Фi,i–1 n,n–1, которые требуются для уточнения решения на следующем шаге по времени. После завершения цикла итераций по фиктивному времени, вычи сленные параллельно внешним устройством ука занные величины передаются в виде коэффициен тов в регистры ячеек и используются на следую щем шаге. Как показано в работе [3], уравнение вида (11) может быть использовано и для граничных узлов разностной сетки, что делает однородную вычи слительную структуру, состоящую из таких ячеек, масштабируемой и реконфигурируемой. Результаты моделирования Система уравнений (6)–(11) для сравнительной оценки эффективности модифицированной ячей ки была реализована и исследована на примере ре шения тестовой краевой задачи (1)–(3) с перемен ной U, соответствующей относительной темпера туре, с начальными и граничными условиями: Для (U,x)=1 известно точное решение этой за дачи: Для численного решения тестовой задачи ис пользовалась модель, состоящая из 11 модифици рованных ячеек, две из которых использовались в качестве граничных, а остальные – в качестве внутренних узлов равномерной разностной сетки. Для (U,x)=1 решение на модели совпадало с точ ным решением с погрешностью, задаваемой для остановки итераций по фиктивному времени . Температурная зависимость коэффициента  задавалась с помощью линейного уравнения где b, c – коэффициенты линейной аппроксима ции зависимости  от температуры. Для оценки величины расхождения решений ур. (1) и (5) были проведены расчеты с постоянным коэффициентом (U,x)=c. По результатам расчетов приведены графики изменения относительной разности решений ур. (1) и (5) U по временным шагам n и по узлам раз количестве итераций (времени решения задачи) для обычной и модифицированной ячеек. На гра ных (1, 11) ячеек расхождение решений увеличива шагах по времени расхождение решений постепен но нарастает и выходит на стационарный уровень. Это обусловлено использованной явнонеявной схемой аппроксимации, которая начинает полно ценно работать только после первых двух шагов U x bU nx U t U t

n n i i

   

    

Известия Томского политехнического университета. 2011. Т. 318. № 5 Функциональная схема взаимодействия ячейки однородной структуры ЯОС и внешнего устройства ВУ на примере двух шагов по времени ȼɍ əɈɋ i i ȼɍ əɈɋ ȼɍ əɈɋ ȼɍ əɈɋ n n i i

по времени. Поэтому в практических расчетах на чальные шаги по времени рекомендуется выбирать меньше, чтобы снизить погрешность. В количественном измерении расхождение ре зультатов моделирования с учетом и без учета тем пературной зависимости коэффициентов не пре высило 5 % в данном примере, но оно тем значи тельнее, чем больше разность между заданными начальными условиями и конечным результатом и чем значительнее температурная зависимость ко эффициента . Выводы Модификация ячейки однородной структуры для решения дифференциальных уравнений в частных производных позволяет организовать вы числение значений коэффициентов, зависящих от искомой переменной, параллельно с расчетом самой переменной. Это дает более точный резуль тат без дополнительного цикла итераций для пе ресчета коэффициентов. Модификация ячейки незначительно увеличи вает аппаратные затраты в самой ячейке (дополни тельный ключевой элемент) за счет выноса аппа ратной реализации зависимости коэффициента от искомой переменной за схему типовой ячейки во внешнее устройство (управляющий микропро цессор), работающее синхронно с ячейкой. Такое решение обеспечивает гибкость замены вида зави симости коэффициентов путем замены программы внешнего устройства без изменения схемы ячеек однородной структуры. Результаты моделирования на примере реше ния тестовой краевой задачи с температурнозави симыми коэффициентами подтвердили работоспо собность модифицированной ячейки. Управление, вычислительная техника и информатика Относительная разность U решений ур. (1) и (5) по узлам разностной сетки i (а) и по временным шагам n (б): h=0,1;

СПИСОК ЛИТЕРАТУРЫ Ячейка однородной структуры для решения дифференциаль ных уравнений в частных производных: пат. 2359322 Рос. Фе дерация. №2007141832/09; заявл. 12.11.2007; опубл. 20.06.2009, Бюл. №17. – 6 с. Хамухин А.А. Ячеечная модель устройства для решения диф ференциальных уравнений в частных производных // Изве стия Томского политехнического университета. – 2010. – Хамухин А.А. Реконфигурирование однородной вычислитель ной структуры с непрограммируемыми ячейками для решения дифференциальных уравнений в частных производных // Из вестия Томского политехнического университета. – 2010. – Абрамов С.М., Дбар С.А., Климов А.В., Климов Ю.А., Ла цис А.О., Московский А.А., Орлов А.Ю., Шворин А.Б. Воз можности суперкомпьютеров «СКИФ» ряда 4 по аппаратной поддержке в ПЛИС различных моделей параллельных вычи слений // Суперкомпьютерные технологии: разработка, про граммирование, применение (СКТ2010): Матер. Междунар. научнотехн. конф. – г. Дивноморское, 27 сент. – 2 окт. 2010. – Таганрог: Издво ТТИ ЮФУ, 2010. – Т. 1. – С. 11–21. http://www.mscsoftware.ru/products/nastran3 (дата обращения: Каляев И.А., Левин И.И., Семерников Е.А., Шмойлов В.И. Реконфигурируемые мультиконвейерные вычислительные структуры. – Ростов на Дону: ЮНЦ РАН, 2008. – 393 с. 2010. URL: http://parallel.ru/FPGA/papers/rmvs.pdf (дата обращения: Александров А.А., Орлов К.А., Очков В.Ф. Webверсия спра вочника «Теплофизические свойства веществ теплоэнергети ращения: 11.01.2011). Поступила 11.01.2011 г.